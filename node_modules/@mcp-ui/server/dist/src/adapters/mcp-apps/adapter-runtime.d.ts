/**
 * MCP-UI to MCP Apps Adapter Runtime
 *
 * This module enables existing MCP-UI apps to run in new MCP Apps SEP environments
 * by intercepting MCP-UI protocol messages and translating them to JSON-RPC over postMessage.
 *
 * Note: This file is bundled as a standalone script injected into HTML.
 * We define types locally to avoid bundling the entire ext-apps package.
 * The types mirror those from @modelcontextprotocol/ext-apps.
 */
/**
 * Current protocol version supported by this adapter.
 * Must match LATEST_PROTOCOL_VERSION from @modelcontextprotocol/ext-apps
 */
declare const PROTOCOL_VERSION = "2025-11-21";
/** Host context from MCP Apps SEP (mirrors McpUiHostContext from ext-apps) */
interface McpUiHostContext {
    toolInfo?: {
        id: string | number;
        tool: unknown;
    };
    theme?: 'light' | 'dark' | 'system';
    displayMode?: 'inline' | 'fullscreen' | 'pip' | 'carousel';
    availableDisplayModes?: string[];
    viewport?: {
        width: number;
        height: number;
        maxHeight?: number;
        maxWidth?: number;
    };
    locale?: string;
    timeZone?: string;
    userAgent?: string;
    platform?: 'web' | 'desktop' | 'mobile';
}
/** Initialize result from MCP Apps SEP (mirrors McpUiInitializeResult from ext-apps) */
interface McpUiInitializeResult {
    protocolVersion: string;
    hostInfo: {
        name: string;
        version: string;
    };
    hostCapabilities: Record<string, unknown>;
    hostContext: McpUiHostContext;
}
/** Configuration for the MCP Apps adapter */
interface McpAppsAdapterConfig {
    logger?: Pick<Console, 'log' | 'warn' | 'error' | 'debug'>;
    timeout?: number;
}
/** Pending request tracking */
interface PendingRequest<T = unknown> {
    messageId: string;
    type: string;
    resolve: (value: T | PromiseLike<T>) => void;
    reject: (error: unknown) => void;
    timeoutId: ReturnType<typeof setTimeout>;
}
/** MCP-UI message types (legacy protocol from widget) */
interface MCPUIMessage {
    type: string;
    messageId?: string;
    payload?: unknown;
}
/** MCP-UI action result (legacy protocol) */
interface UIActionResult {
    type: string;
    messageId?: string;
    payload?: Record<string, unknown>;
}
type ParentPostMessage = Window['postMessage'];
declare class McpAppsAdapter {
    private config;
    private pendingRequests;
    private messageIdCounter;
    private originalPostMessage;
    private parentWindow;
    private hostCapabilities;
    private hostContext;
    private initialized;
    private currentRenderData;
    constructor(config?: McpAppsAdapterConfig);
    install(): boolean;
    /**
     * Performs the MCP Apps SEP initialization handshake:
     * 1. Send ui/initialize request with adapter info
     * 2. Receive host capabilities and context
     * 3. Send ui/notifications/initialized notification
     * 4. Dispatch ready event to MCP-UI app
     */
    private performInitialization;
    uninstall(): void;
    private patchPostMessage;
    private isMCPUIMessage;
    /**
     * Handles messages coming from the Host (JSON-RPC) and translates them to MCP-UI messages
     *
     * MCP Apps SEP protocol methods (from @modelcontextprotocol/ext-apps):
     * - ui/notifications/tool-input: Complete tool arguments
     * - ui/notifications/tool-input-partial: Streaming partial tool arguments
     * - ui/notifications/tool-result: Tool execution results
     * - ui/notifications/host-context-changed: Theme, viewport, locale changes
     * - ui/notifications/size-change: Size change notifications (bidirectional)
     */
    private handleHostMessage;
    /**
     * Handles messages coming from the App (MCP-UI) and translates them to Host (JSON-RPC)
     *
     * MCP-UI message types translated to MCP Apps SEP:
     * - 'tool' -> tools/call request
     * - 'ui-size-change' -> ui/notifications/size-change notification
     * - 'notify' -> notifications/message notification (logging)
     * - 'link' -> ui/open-link request
     * - 'prompt' -> ui/message request
     * - 'ui-lifecycle-iframe-ready' -> ui/notifications/initialized notification
     */
    private handleMCPUIMessage;
    /**
     * Send current render data to the MCP-UI app
     * This mirrors the Apps SDK adapter's sendRenderData method
     */
    private sendRenderData;
    private sendJsonRpcRequest;
    private sendJsonRpcNotification;
    private dispatchMessageToIframe;
    private generateMessageId;
    private generateJsonRpcId;
}
declare let adapterInstance: McpAppsAdapter | null;
declare function initAdapter(config?: McpAppsAdapterConfig): boolean;
declare function uninstallAdapter(): void;
//# sourceMappingURL=adapter-runtime.d.ts.map